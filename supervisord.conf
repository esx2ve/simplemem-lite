[supervisord]
nodaemon=true
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid
loglevel=info

[program:sysctl-init]
command=/bin/sh -c "sysctl -w vm.overcommit_memory=1 || true"
priority=0
autostart=true
autorestart=false
startsecs=0
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:memgraph]
command=memgraph --data-directory=/data --storage-wal-enabled=true --storage-snapshot-on-exit=true --storage-recover-on-startup=true --log-level=WARNING
directory=/data
priority=1
autostart=true
autorestart=true
startretries=3
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:api]
command=python -m simplemem_lite.backend.main
directory=/app
priority=2
autostart=true
autorestart=true
startretries=3
startsecs=10
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
; Memgraph starts first via priority=1, API starts after via priority=2
